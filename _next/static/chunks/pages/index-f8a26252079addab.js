(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{4930:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__N_SSG:()=>u,default:()=>d});var n=r(7876),l=r(4232);let a=e=>{let{options:t,selected:r,onChange:a,label:o}=e,[s,c]=(0,l.useState)(""),i=e=>{a(r.includes(e)?r.filter(t=>t!==e):[...r,e])},u=t.filter(e=>e.toLowerCase().includes(s.toLowerCase())),d=r.length===t.length;return(0,n.jsxs)("div",{children:[o&&(0,n.jsx)("p",{children:(0,n.jsx)("strong",{children:o})}),(0,n.jsx)("input",{type:"text",value:s,onChange:e=>c(e.target.value),placeholder:"Pesquise uma op\xe7\xe3o",style:{marginBottom:"10px",padding:"5px",width:"100%"}}),(0,n.jsx)("div",{style:{marginBottom:"10px"},children:(0,n.jsxs)("label",{children:[(0,n.jsx)("input",{type:"checkbox",checked:d,onChange:()=>{r.length===t.length?a([]):a([...t])}})," ","Selecionar tudo"]})}),""!==s.trim()&&(0,n.jsx)("ul",{style:{listStyle:"none",padding:0},children:u.map(e=>(0,n.jsx)("li",{children:(0,n.jsxs)("label",{children:[(0,n.jsx)("input",{type:"checkbox",value:e,checked:r.includes(e),onChange:()=>i(e)})," ",e]})},e))})]})};var o=r(9470);let s=e=>{let{width:t=900,height:r=900,geoData:a,points:s=[],onBrushSelection:c,color:i}=e,u=(0,l.useRef)(null),[d,p]=l.useState(!1),[h,f]=l.useState(!1),[m,g]=l.useState(!1),b=i||o.UMr(o.t55),v=(0,l.useRef)(null),x=(0,l.useRef)(null),y=(0,l.useRef)(()=>{}),w=(0,l.useRef)(null),j=(0,l.useRef)(!1),N=(0,l.useRef)(null),M=e=>{var t;if(e.preventDefault(),!v.current)return;let r=e.deltaY<0?1.1:.9,n=v.current.scale();v.current.scale(n*r),null===(t=y.current)||void 0===t||t.call(y)},k=e=>{j.current=!0,N.current=[e.clientX,e.clientY],e.preventDefault()},C=e=>{var t;if(!j.current||!N.current||!v.current)return;let[r,n]=N.current,l=e.clientX-r,a=e.clientY-n,o=v.current.rotate();v.current.rotate([o[0]+.25*l,o[1]-.25*a,o[2]]),N.current=[e.clientX,e.clientY],null===(t=y.current)||void 0===t||t.call(y)};return(0,l.useEffect)(()=>{f(!0);let e=o.Ltv(u.current);e.on("wheel",M),e.on("mousedown",k),e.on("mousemove",C),e.selectAll("path").remove(),e.selectAll("circle").remove();let n=o.Ltv(u.current.parentElement).append("div").style("position","absolute").style("background","rgba(0, 0, 0, 0.7)").style("color","white").style("padding","6px 10px").style("border","1px solid #999").style("border-radius","4px").style("font-size","12px").style("pointer-events","none");if(v.current=d?o.uVR().scale(Math.min(t,r)/2.2).translate([t/2,r/2]):o.WK6().scale(Math.min(t,r)/2.2).translate([t/2,r/2]),!a)return;x.current=o.zFW().projection(v.current),e.append("defs").append("clipPath").attr("id","globeClip").append("path").datum({type:"Sphere"}).attr("d",x.current);let l=e.append("g"),i=!1;y.current=()=>{let[e,t]=v.current.rotate(),r=[-e,-t],c=s.filter(e=>o.Je2([e.lng,e.lat],r)<=Math.PI/2);p.attr("d",x.current({type:"Sphere"})),l.selectAll("path.country").data(a.features).join(e=>e.append("path").attr("class","country").attr("d",x.current).attr("fill","#ffddcc").attr("stroke","#fff"),e=>e.attr("d",x.current),e=>e.remove()),l.selectAll("circle").data(c).join(e=>e.append("circle").attr("cx",e=>v.current([e.lng,e.lat])[0]).attr("cy",e=>v.current([e.lng,e.lat])[1]).attr("r",e=>2*Math.sqrt(e.howMany)).attr("fill","red").attr("opacity",.5).attr("fill",e=>b(e.comName)).on("mouseover",(e,t)=>{n.html("<strong>Esp\xe9cie:</strong> ".concat(t.comName,"<br/><strong>Quantidade:</strong> ").concat(t.howMany)).style("opacity",1).style("visibility","visible")}).on("mousemove",e=>{let t=u.current.getBoundingClientRect();n.style("left","".concat(e.clientX-t.left+10,"px")).style("top","".concat(e.clientY-t.top-28,"px"))}).on("mouseout",()=>{n.style("opacity",0)}),e=>e.attr("cx",e=>v.current([e.lng,e.lat])[0]).attr("cy",e=>v.current([e.lng,e.lat])[1]),e=>e.remove())},o.Ltv(window).on("mouseup",()=>{i&&(i=!1)}),o.Ltv(window).on("mouseleave",()=>{i&&(i=!1)});let p=l.append("path").datum({type:"Sphere"}).attr("fill","#aadaff");return y.current(),l.selectAll("path.country").data(a.features).enter().append("path").attr("class","country").attr("d",x.current).attr("fill","#ffddcc").attr("stroke","#fff"),w.current=o.V$7().extent([[0,0],[t,r]]).on("start",()=>{g(!0),e.on("wheel",null),e.on("mousedown",null)}).on("end",n=>{if(!n.selection){g(!1);return}if("function"!=typeof v.current.invert){console.warn("Projection does not support invert.");return}console.log("brush end",n.selection);let[[l,a],[s,i]]=n.selection,u=v.current.invert([l,a]),d=v.current.invert([s,i]);if(console.log("p0",u,"p1",d),!u||!d){console.log("Sele\xe7\xe3o fora da esfera, ignorando.");return}c&&c([[u[0],u[1]],[d[0],d[1]]]);let p=(u[0]+d[0])/2,h=(u[1]+d[1])/2,f=Math.min(t,r)/Math.max(Math.abs(s-l),Math.abs(i-a))*v.current.scale()*.5;v.current.scale(f),v.current.rotate([-p,-h]),x.current=o.zFW().projection(v.current),y.current(),e.on("wheel",M),e.on("mousedown",k),e.on("mousemove",C),g(!1)}),()=>{n.remove()}},[a,t,r,s,c,d]),(0,l.useEffect)(()=>{let e=o.Ltv(u.current);e.selectAll(".brush").remove(),m&&w.current&&e.append("g").attr("class","brush").call(w.current).raise()},[m]),(0,l.useEffect)(()=>{let e=()=>{j.current=!1,N.current=null};return window.addEventListener("mouseup",e),window.addEventListener("mouseleave",e),()=>{window.removeEventListener("mouseup",e),window.removeEventListener("mouseleave",e)}},[]),(0,l.useEffect)(()=>{var e;if(!s.length||!v.current)return;let t=o.i2o(s,e=>e.lng),r=o.i2o(s,e=>e.lat);v.current.rotate([-t,-r]),null===(e=y.current)||void 0===e||e.call(y)},[s]),(0,n.jsxs)("div",{style:{position:"relative"},children:[(0,n.jsx)("svg",{ref:u,width:t,height:r,style:{cursor:"grab",backgroundColor:"#0a0a0a"}}),h&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{onClick:()=>p(e=>!e),style:{position:"absolute",top:10,right:10,padding:"8px 12px",backgroundColor:"#4dabf7",border:"none",borderRadius:"8px",color:"#fff",cursor:"pointer"},children:d?"Voltar ao globo":"Flatten globe"}),(0,n.jsx)("button",{onClick:()=>{g(e=>!e)},style:{position:"absolute",top:50,right:10,padding:"8px 12px",backgroundColor:"#82c91e",border:"none",borderRadius:"8px",color:"#fff",cursor:"pointer"},children:m?"Desabilitar Brush":"Habilitar Brush"})]})]})},c=e=>{let{data:t,width:r=350,height:a=900,color:s}=e,c=(0,l.useRef)(null),i=s||o.UMr(o.t55);return(0,l.useEffect)(()=>{let e=o.Ltv(c.current);if(e.selectAll("*").remove(),!t||0===t.length)return;let n=o.Ltv("body").append("div").style("position","absolute").style("padding","6px").style("background","rgba(0, 0, 0, 0.7)").style("color","white").style("border-radius","4px").style("pointer-events","none").style("font-size","12px").style("display","none"),l={top:20,right:30,bottom:40,left:100},s=r-l.left-l.right,u=a-l.top-l.bottom,d=[...t].sort((e,t)=>o.rGT(e.howMany,t.howMany)),p=o.m4Y().domain([0,o.T9B(d,e=>e.howMany)]).nice().range([0,s]),h=o.WH().domain(d.map(e=>e.locName)).range([0,u]).padding(.1),f=e.append("g").attr("transform","translate(".concat(l.left,",").concat(l.top,")"));f.append("g").call(o.V4s(h)),f.append("g").attr("transform","translate(0,".concat(u,")")).call(o.l78(p)),f.selectAll("rect").data(d).enter().append("rect").attr("x",0).attr("y",e=>h(e.locName)).attr("height",h.bandwidth()).attr("width",e=>p(e.howMany)).attr("fill",e=>i(e.comName)).on("mouseover",(e,t)=>{n.style("display","block").html("\n            <strong>".concat(t.comName,"</strong><br/>\n            Local: ").concat(t.locName,"<br/>\n            Quantidade: ").concat(t.howMany,"\n          "))}).on("mousemove",e=>{n.style("left",e.pageX+10+"px").style("top",e.pageY-28+"px")}).on("mouseout",()=>{n.style("display","none")})},[t,r,a]),(0,n.jsx)("svg",{ref:c,width:r,height:a})};var i=r(5198),u=!0;function d(e){let{global_data:t,list_visible:r}=e,[u,d]=(0,l.useState)([]),[p,h]=(0,l.useState)([]),[f,m]=(0,l.useState)(null),g=(0,l.useMemo)(()=>t.filter(e=>u.includes(e.comName)),[u,t]),b=o.UMr().domain(Array.from(new Set(r.map(e=>e.comName)))).range(["#e41a1c","#377eb8","#4daf4a","#ff7f00","#ffff33","#a65628","#f781bf","#999999","#d95f02","#1b9e77","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666","#1f77b4","#ff9896","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#8c8c8c","#9b59b6","#d62728","#ff7f0e","#2ca02c"]);(0,l.useEffect)(()=>{m(i),p.length>0&&console.log("Usando dados filtrados fora do handleBrush:",p)},[p]);let v=(0,l.useCallback)(e=>{if(!e){h([]);return}let[[t,r],[n,l]]=e;console.log(e);let a=Math.min(t,n),o=Math.max(t,n),s=Math.min(r,l),c=Math.max(r,l),i=g.filter(e=>{let t=e.lng,r=e.lat;return t>=a&&t<=o&&r>=s&&r<=c});console.log(i),h(i)},[g]);return(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"bg-white-100 p-4 max-h-60 overflow-auto",children:(0,n.jsx)(a,{options:r,selected:u,onChange:d,label:"Select options"})}),(0,n.jsx)("div",{className:"bg-white-100 p-4 max-h-60 overflow-auto",children:u.length>0?(0,n.jsx)("div",{className:"p-4",children:(0,n.jsx)("ul",{className:"list-none p-0",children:u.map(e=>(0,n.jsx)("li",{className:"mb-2 flex items-center",children:(0,n.jsx)("button",{onClick:()=>{d(u.filter(t=>t!==e))},style:{backgroundColor:b(e)},className:"ml-2 px-2 py-1 bg-red-500 text-white rounded hover:bg-600",children:e})},e))})}):(0,n.jsx)("p",{className:"p-4",children:"Nenhum selecionado"})}),(0,n.jsxs)("div",{className:"grid grid-cols-[25%_75%] w-full h-screen",children:[(0,n.jsx)("div",{className:"bg-black-100 p-4",children:(0,n.jsx)(c,{data:0===u.length?[]:p.length>0?p:g,color:b})}),(0,n.jsx)("div",{className:"w-full h-screen bg-white-100 p-4",children:(0,n.jsx)(s,{geoData:f,points:g,onBrushSelection:v,color:b})})]})]})}},6760:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(4930)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[232,198,636,593,792],()=>t(6760)),_N_E=e.O()}]);