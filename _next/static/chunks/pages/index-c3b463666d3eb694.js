(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{1896:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var l=a(7876),r=a(4232),n=a(3722);let o=e=>{let{data:t,width:a=600,height:o=400}=e,s=(0,r.useRef)(null);return(0,r.useEffect)(()=>{if(!t||0===t.length)return;let e=n.Ltv(s.current);e.selectAll("*").remove();let l={top:20,right:30,bottom:40,left:40},r=a-l.left-l.right,i=o-l.top-l.bottom,c=n.WH().domain(t.map(e=>e.label)).range([0,r]).padding(.1),d=n.m4Y().domain([0,n.T9B(t,e=>e.value)]).nice().range([i,0]),u=e.append("g").attr("transform","translate(".concat(l.left,",").concat(l.top,")"));u.append("g").call(n.V4s(d)),u.append("g").attr("transform","translate(0,".concat(i,")")).call(n.l78(c)),u.selectAll("rect").data(t).enter().append("rect").attr("x",e=>c(e.label)).attr("y",e=>d(e.value)).attr("width",c.bandwidth()).attr("height",e=>i-d(e.value)).attr("fill","#4dabf7")},[t,a,o]),(0,l.jsx)("svg",{ref:s,width:a,height:o})}},2052:(e,t,a)=>{"use strict";a.d(t,{K:()=>n});var l=a(7876),r=a(4232);let n=e=>{let{options:t,selected:a,onChange:n,label:o}=e,[s,i]=(0,r.useState)(""),c=e=>{n(a.includes(e)?a.filter(t=>t!==e):[...a,e])},d=t.filter(e=>e.toLowerCase().includes(s.toLowerCase()));return(0,l.jsxs)("div",{children:[o&&(0,l.jsx)("p",{children:(0,l.jsx)("strong",{children:o})}),(0,l.jsx)("input",{type:"text",value:s,onChange:e=>i(e.target.value),placeholder:"Pesquise uma op\xe7\xe3o",style:{marginBottom:"10px",padding:"5px",width:"100%"}}),(0,l.jsx)("ul",{style:{listStyle:"none",padding:0},children:d.map(e=>(0,l.jsx)("li",{children:(0,l.jsxs)("label",{children:[(0,l.jsx)("input",{type:"checkbox",value:e,checked:a.includes(e),onChange:()=>c(e)})," ",e]})},e))})]})}},5098:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var l=a(7876),r=a(4232),n=a(3722);let o=e=>{let{width:t=800,height:a=450,geoData:o,points:s=[],onBrushSelection:i}=e,c=(0,r.useRef)(null),[d,u]=r.useState(!1),[p,h]=r.useState(!1),[f,g]=r.useState(!1);return(0,r.useEffect)(()=>{h(!0);let e=n.Ltv(c.current);e.selectAll("path").remove(),e.selectAll("circle").remove();let l=n.Ltv(c.current.parentElement).append("div").style("position","absolute").style("background","white").style("padding","5px 10px").style("border","1px solid #999").style("border-radius","4px").style("pointer-events","none").style("opacity",0),r=d?n.uVR().scale(Math.min(t,a)/2.2).translate([t/2,a/2]):n.WK6().scale(Math.min(t,a)/2.2).translate([t/2,a/2]);if(!o)return;let u=n.zFW().projection(r);e.append("defs").append("clipPath").attr("id","globeClip").append("path").datum({type:"Sphere"}).attr("d",u);let p=e.append("g"),m=!1,v=null,x=e=>{e.preventDefault();let t=e.deltaY<0?1.1:.9,a=r.scale();r.scale(a*t),b()},y=e=>{if(!m||!v)return;let[t,a]=v,l=e.clientX-t,n=e.clientY-a,o=r.rotate();r.rotate([o[0]+.25*l,o[1]-.25*n,o[2]]),v=[e.clientX,e.clientY],b()},b=()=>{w.attr("d",u({type:"Sphere"})),p.selectAll("path.country").data(o.features).join(e=>e.append("path").attr("class","country").attr("d",u).attr("fill","#efa400").attr("stroke","#fff"),e=>e.attr("d",u),e=>e.remove());let[e,t]=r.rotate(),a=[-e,-t],i=s.filter(e=>n.Je2([e.lng,e.lat],a)<=Math.PI/2);p.selectAll("circle").data(i).join(e=>e.append("circle").attr("cx",e=>r([e.lng,e.lat])[0]).attr("cy",e=>r([e.lng,e.lat])[1]).attr("r",e=>2*Math.sqrt(e.howMany)).attr("fill","red").attr("opacity",.5).on("mouseover",(e,t)=>{l.html("<strong>Esp\xe9cie:</strong> ".concat(t.comName,"<br/><strong>Quantidade:</strong> ").concat(t.howMany)).style("opacity",1)}).on("mousemove",e=>{l.style("left","".concat(e.pageX+10,"px")).style("top","".concat(e.pageY-28,"px"))}).on("mouseout",()=>{l.style("opacity",0)}),e=>e.attr("cx",e=>r([e.lng,e.lat])[0]).attr("cy",e=>r([e.lng,e.lat])[1]),e=>e.remove())};e.on("wheel",e=>{e.preventDefault();let t=e.deltaY<0?1.1:.9,a=r.scale();r.scale(a*t),b()}),e.on("mousedown",e=>{m=!0,v=[e.clientX,e.clientY],e.preventDefault()}),e.on("mousemove",e=>{if(!m||!v)return;let[t,a]=v,l=e.clientX-t,n=e.clientY-a,o=r.rotate();r.rotate([o[0]+.25*l,o[1]-.25*n,o[2]]),v=[e.clientX,e.clientY],b()}),n.Ltv(window).on("mouseup",()=>{m&&(m=!1,v=null)}),n.Ltv(window).on("mouseleave",()=>{m&&(m=!1,v=null)});let w=p.append("path").datum({type:"Sphere"}).attr("fill","#aadaff");b(),p.selectAll("path.country").data(o.features).enter().append("path").attr("class","country").attr("d",u).attr("fill","#efa400").attr("stroke","#fff");let j=n.V$7().extent([[0,0],[t,a]]).on("start",()=>{g(!0),e.on("wheel",null),e.on("mousedown",null)}).on("end",l=>{if(!l.selection){g(!1);return}if("function"!=typeof r.invert){console.warn("Projection does not support invert.");return}let[[n,o],[s,c]]=l.selection,d=r.invert([n,o]),u=r.invert([s,c]);if(console.log("p0",d,"p1",u),!d||!u){console.log("Sele\xe7\xe3o fora da esfera, ignorando.");return}i&&i([[d[0],d[1]],[u[0],u[1]]]);let p=(d[0]+u[0])/2,h=(d[1]+u[1])/2,f=Math.min(t,a)/Math.max(Math.abs(s-n),Math.abs(c-o))*r.scale()*.5;r.scale(f),r.rotate([-p,-h]),b(),i&&i([d,u]),g(!1),e.on("wheel",x),e.on("mousedown",y)});return f?(e.select(".brush").remove(),e.append("g").attr("class","brush").call(j)):e.select(".brush").remove(),()=>{l.remove()}},[o,t,a,s,i,d]),(0,l.jsxs)("div",{style:{position:"relative"},children:[(0,l.jsx)("svg",{ref:c,width:t,height:a,style:{cursor:"grab",backgroundColor:"#000"}}),p&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{onClick:()=>u(e=>!e),style:{position:"absolute",top:10,right:10,padding:"8px 12px",backgroundColor:"#4dabf7",border:"none",borderRadius:"8px",color:"#fff",cursor:"pointer"},children:d?"Voltar ao globo":"Flatten globe"}),(0,l.jsx)("button",{onClick:()=>{g(e=>!e)},style:{position:"absolute",top:50,right:10,padding:"8px 12px",backgroundColor:"#82c91e",border:"none",borderRadius:"8px",color:"#fff",cursor:"pointer"},children:f?"Desabilitar Brush":"Habilitar Brush"})]})]})}},6760:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(9306)}])},9306:(e,t,a)=>{"use strict";a.a(e,async(e,l)=>{try{a.r(t),a.d(t,{__N_SSG:()=>h,default:()=>f});var r=a(7876),n=a(4939),o=a(2052),s=a(4232),i=a(9833),c=a(5098),d=a(1896),u=a(5198),p=e([i]);i=(p.then?(await p)():p)[0];var h=!0;function f(e){let{global_data:t}=e,[a,l]=(0,s.useState)([]),[p,h]=(0,s.useState)([]),[f,g]=(0,s.useState)(null),m=(0,s.useMemo)(()=>t.filter(e=>a.includes(e.comName)),[a,t]);console.log("filteredOptions",m),(0,s.useEffect)(()=>{g(u),p.length>0&&console.log("Usando dados filtrados fora do handleBrush:",p)},[p]);let v=(0,s.useCallback)(e=>{if(!e){h([]);return}let[[t,a],[l,r]]=e,n=Math.min(t,l),o=Math.max(t,l),s=Math.min(a,r),i=Math.max(a,r),c=p.filter(e=>{let t=e.lng,a=e.lat;return t>=n&&t<=o&&a>=s&&a<=i});h(c)},[p]);return console.log("geoData",p),(0,r.jsxs)("div",{children:[(0,r.jsx)(n.A,{}),(0,r.jsxs)("div",{className:"grid grid-cols-[70%_30%] w-full h-screen",children:[(0,r.jsx)("div",{className:"bg-white-100 p-4",children:(0,r.jsx)(c.A,{geoData:f,points:m,onBrushSelection:v})}),(0,r.jsx)("div",{className:"bg-yellow-100 p-4",children:(0,r.jsx)(o.K,{options:i.id,selected:a,onChange:l,label:"Select options"})})]}),(0,r.jsx)("div",{className:"bg-white-100 p-4 max-h-60 overflow-auto",children:(0,r.jsx)(d.A,{data:m.map(e=>({label:e.locName,value:e.howMany}))})}),(0,r.jsx)("p",{children:a.join(", ")||"Nenhum selecionado"})]})}l()}catch(e){l(e)}})},9833:(e,t,a)=>{"use strict";a.a(e,async(e,l)=>{try{a.d(t,{id:()=>h});var r=a(7085),n=a.n(r),o=a(1040),s=a(5364);o.A.get("http://exemplo.com",{timeout:1e5}).then(e=>console.log(e.data)).catch(e=>console.error(e));let e=await u("https://api.ebird.org/v2/ref/taxonomy/ebird");await d("https://api.ebird.org/v2/ref/region/list/country/world");let h=await i(e,"COMMON_NAME");async function i(e,t){return[...new Set(e.data.map(e=>e[t]))]}async function c(e){var t;return null!==(t=e.meta.fields)&&void 0!==t?t:[]}async function d(e){let t=await fetch(e,{headers:{"X-eBirdApiToken":s.env.EB_TOKEN}});return t.ok?await t.json():(console.error("Erro na resposta da API: ".concat(t.status)),p())}async function u(e){let t=await fetch(e,{headers:{"X-eBirdApiToken":s.env.EB_TOKEN}});if(!t.ok)return console.error("Erro na resposta da API: ".concat(t.status)),p();let a=await t.text();return n().parse(a,{header:!0,skipEmptyLines:!0})}function p(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{data:[],errors:e,meta:{delimiter:"",linebreak:"",aborted:!1,truncated:!1,cursor:0}}}await c(e),l()}catch(e){l(e)}},1)}},e=>{var t=t=>e(e.s=t);e.O(0,[230,722,172,244,636,593,792],()=>t(6760)),_N_E=e.O()}]);