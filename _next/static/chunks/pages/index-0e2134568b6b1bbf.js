(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{4930:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__N_SSG:()=>d,default:()=>p});var n=r(7876),l=r(4939),a=r(4232);let o=e=>{let{options:t,selected:r,onChange:l,label:o}=e,[s,c]=(0,a.useState)(""),i=e=>{l(r.includes(e)?r.filter(t=>t!==e):[...r,e])},u=t.filter(e=>e.toLowerCase().includes(s.toLowerCase()));return(0,n.jsxs)("div",{children:[o&&(0,n.jsx)("p",{children:(0,n.jsx)("strong",{children:o})}),(0,n.jsx)("input",{type:"text",value:s,onChange:e=>c(e.target.value),placeholder:"Pesquise uma op\xe7\xe3o",style:{marginBottom:"10px",padding:"5px",width:"100%"}}),""!==s.trim()&&(0,n.jsx)("ul",{style:{listStyle:"none",padding:0},children:u.map(e=>(0,n.jsx)("li",{children:(0,n.jsxs)("label",{children:[(0,n.jsx)("input",{type:"checkbox",value:e,checked:r.includes(e),onChange:()=>i(e)})," ",e]})},e))})]})};var s=r(9470);let c=e=>{let{width:t=800,height:r=450,geoData:l,points:o=[],onBrushSelection:c,color:i}=e,u=(0,a.useRef)(null),[d,p]=a.useState(!1),[h,f]=a.useState(!1),[m,g]=a.useState(!1),v=i||s.UMr(s.t55),x=(0,a.useRef)(null),b=(0,a.useRef)(null),w=(0,a.useRef)(()=>{}),y=(0,a.useRef)(null),j=(0,a.useRef)(!1),N=(0,a.useRef)(null),M=e=>{var t;if(e.preventDefault(),!x.current)return;let r=e.deltaY<0?1.1:.9,n=x.current.scale();x.current.scale(n*r),null===(t=w.current)||void 0===t||t.call(w)},S=e=>{j.current=!0,N.current=[e.clientX,e.clientY],e.preventDefault()},k=e=>{var t;if(!j.current||!N.current||!x.current)return;let[r,n]=N.current,l=e.clientX-r,a=e.clientY-n,o=x.current.rotate();x.current.rotate([o[0]+.25*l,o[1]-.25*a,o[2]]),N.current=[e.clientX,e.clientY],null===(t=w.current)||void 0===t||t.call(w)};return(0,a.useEffect)(()=>{f(!0);let e=s.Ltv(u.current);e.on("wheel",M),e.on("mousedown",S),e.on("mousemove",k),e.selectAll("path").remove(),e.selectAll("circle").remove();let n=s.Ltv(u.current.parentElement).append("div").style("position","absolute").style("background","white").style("padding","5px 10px").style("border","1px solid #999").style("border-radius","4px").style("pointer-events","none").style("opacity",0);if(x.current=d?s.uVR().scale(Math.min(t,r)/2.2).translate([t/2,r/2]):s.WK6().scale(Math.min(t,r)/2.2).translate([t/2,r/2]),!l)return;b.current=s.zFW().projection(x.current),e.append("defs").append("clipPath").attr("id","globeClip").append("path").datum({type:"Sphere"}).attr("d",b.current);let a=e.append("g"),i=!1;w.current=()=>{let[e,t]=x.current.rotate(),r=[-e,-t],c=o.filter(e=>s.Je2([e.lng,e.lat],r)<=Math.PI/2);p.attr("d",b.current({type:"Sphere"})),a.selectAll("path.country").data(l.features).join(e=>e.append("path").attr("class","country").attr("d",b.current).attr("fill","#ffddcc").attr("stroke","#fff"),e=>e.attr("d",b.current),e=>e.remove()),a.selectAll("circle").data(c).join(e=>e.append("circle").attr("cx",e=>x.current([e.lng,e.lat])[0]).attr("cy",e=>x.current([e.lng,e.lat])[1]).attr("r",e=>2*Math.sqrt(e.howMany)).attr("fill","red").attr("opacity",.5).attr("fill",e=>v(e.comName)).on("mouseover",(e,t)=>{n.html("<strong>Esp\xe9cie:</strong> ".concat(t.comName,"<br/><strong>Quantidade:</strong> ").concat(t.howMany)).style("opacity",1).style("visibility","visible")}).on("mousemove",e=>{let t=u.current.getBoundingClientRect();n.style("left","".concat(e.clientX-t.left+10,"px")).style("top","".concat(e.clientY-t.top-28,"px"))}).on("mouseout",()=>{n.style("opacity",0)}),e=>e.attr("cx",e=>x.current([e.lng,e.lat])[0]).attr("cy",e=>x.current([e.lng,e.lat])[1]),e=>e.remove())},s.Ltv(window).on("mouseup",()=>{i&&(i=!1)}),s.Ltv(window).on("mouseleave",()=>{i&&(i=!1)});let p=a.append("path").datum({type:"Sphere"}).attr("fill","#aadaff");return w.current(),a.selectAll("path.country").data(l.features).enter().append("path").attr("class","country").attr("d",b.current).attr("fill","#ffddcc").attr("stroke","#fff"),y.current=s.V$7().extent([[0,0],[t,r]]).on("start",()=>{g(!0),e.on("wheel",null),e.on("mousedown",null)}).on("end",n=>{if(!n.selection){g(!1);return}if("function"!=typeof x.current.invert){console.warn("Projection does not support invert.");return}console.log("brush end",n.selection);let[[l,a],[o,i]]=n.selection,u=x.current.invert([l,a]),d=x.current.invert([o,i]);if(console.log("p0",u,"p1",d),!u||!d){console.log("Sele\xe7\xe3o fora da esfera, ignorando.");return}c&&c([[u[0],u[1]],[d[0],d[1]]]);let p=(u[0]+d[0])/2,h=(u[1]+d[1])/2,f=Math.min(t,r)/Math.max(Math.abs(o-l),Math.abs(i-a))*x.current.scale()*.5;x.current.scale(f),x.current.rotate([-p,-h]),b.current=s.zFW().projection(x.current),w.current(),e.on("wheel",M),e.on("mousedown",S),e.on("mousemove",k),g(!1)}),()=>{n.remove()}},[l,t,r,o,c,d]),(0,a.useEffect)(()=>{let e=s.Ltv(u.current);e.selectAll(".brush").remove(),m&&y.current&&e.append("g").attr("class","brush").call(y.current).raise()},[m]),(0,a.useEffect)(()=>{let e=()=>{j.current=!1,N.current=null};return window.addEventListener("mouseup",e),window.addEventListener("mouseleave",e),()=>{window.removeEventListener("mouseup",e),window.removeEventListener("mouseleave",e)}},[]),(0,a.useEffect)(()=>{var e;if(!o.length||!x.current)return;let t=s.i2o(o,e=>e.lng),r=s.i2o(o,e=>e.lat);x.current.rotate([-t,-r]),null===(e=w.current)||void 0===e||e.call(w)},[o]),(0,n.jsxs)("div",{style:{position:"relative"},children:[(0,n.jsx)("svg",{ref:u,width:t,height:r,style:{cursor:"grab",backgroundColor:"#000"}}),h&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{onClick:()=>p(e=>!e),style:{position:"absolute",top:10,right:10,padding:"8px 12px",backgroundColor:"#4dabf7",border:"none",borderRadius:"8px",color:"#fff",cursor:"pointer"},children:d?"Voltar ao globo":"Flatten globe"}),(0,n.jsx)("button",{onClick:()=>{g(e=>!e)},style:{position:"absolute",top:50,right:10,padding:"8px 12px",backgroundColor:"#82c91e",border:"none",borderRadius:"8px",color:"#fff",cursor:"pointer"},children:m?"Desabilitar Brush":"Habilitar Brush"})]})]})},i=e=>{let{data:t,width:r=600,height:l=400,color:o}=e,c=(0,a.useRef)(null),i=o||s.UMr(s.t55);return(0,a.useEffect)(()=>{if(!t||0===t.length)return;let e=s.Ltv(c.current);e.selectAll("*").remove();let n={top:20,right:30,bottom:40,left:100},a=r-n.left-n.right,o=l-n.top-n.bottom,u=s.m4Y().domain([0,s.T9B(t,e=>e.howMany)]).nice().range([0,a]),d=s.WH().domain(t.map(e=>e.locName)).range([0,a]).padding(.1),p=e.append("g").attr("transform","translate(".concat(n.left,",").concat(n.top,")"));p.append("g").call(s.V4s(d)),p.append("g").attr("transform","translate(0,".concat(o,")")).call(s.l78(u)),p.selectAll("rect").data(t).enter().append("rect").attr("x",0).attr("y",e=>d(e.locName)).attr("height",d.bandwidth()).attr("width",e=>u(e.howMany)).attr("fill",e=>i(e.comName))},[t,r,l]),(0,n.jsx)("svg",{ref:c,width:r,height:l})};var u=r(5198),d=!0;function p(e){let{global_data:t,list_visible:r}=e,[d,p]=(0,a.useState)([]),[h,f]=(0,a.useState)([]),[m,g]=(0,a.useState)(null),v=(0,a.useMemo)(()=>t.filter(e=>d.includes(e.comName)),[d,t]),x=s.UMr().domain(Array.from(new Set(r.map(e=>e.comName)))).range(s.t55);(0,a.useEffect)(()=>{g(u),h.length>0&&console.log("Usando dados filtrados fora do handleBrush:",h)},[h]);let b=(0,a.useCallback)(e=>{if(!e){f([]);return}let[[t,r],[n,l]]=e;console.log(e);let a=Math.min(t,n),o=Math.max(t,n),s=Math.min(r,l),c=Math.max(r,l),i=v.filter(e=>{let t=e.lng,r=e.lat;return t>=a&&t<=o&&r>=s&&r<=c});console.log(i),f(i)},[v]);return console.log("geoData",h),(0,n.jsxs)("div",{children:[(0,n.jsx)(l.A,{}),(0,n.jsx)("div",{className:"bg-white-100 p-4 max-h-60 overflow-auto",children:(0,n.jsx)(o,{options:r,selected:d,onChange:p,label:"Select options"})}),(0,n.jsx)("div",{className:"bg-white-100 p-4 max-h-60 overflow-auto",children:d.length>0?(0,n.jsxs)("div",{className:"p-4",children:[(0,n.jsx)("h2",{className:"text-lg font-bold mb-2",children:"Selecionados:"}),(0,n.jsx)("ul",{className:"list-none p-0",children:d.map(e=>(0,n.jsx)("li",{className:"mb-2 flex items-center",children:(0,n.jsx)("button",{onClick:()=>{p(d.filter(t=>t!==e))},style:{backgroundColor:x(e)},className:"ml-2 px-2 py-1 bg-red-500 text-white rounded hover:bg-600",children:e})},e))})]}):(0,n.jsx)("p",{className:"p-4",children:"Nenhum selecionado"})}),(0,n.jsxs)("div",{className:"grid grid-cols-[70%_30%] w-full h-screen",children:[(0,n.jsx)("div",{className:"bg-white-100 p-4",children:(0,n.jsx)(c,{geoData:m,points:v,onBrushSelection:b})}),(0,n.jsx)("div",{className:"bg-yellow-100 p-4",children:(0,n.jsx)(i,{data:h.length>0?h:v,color:x})})]})]})}},6760:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(4930)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[230,232,244,636,593,792],()=>t(6760)),_N_E=e.O()}]);